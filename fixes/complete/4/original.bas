1     REM LABYRINTH BY COMMODORE, UPDATED FOR X16 BY JUSTIN BALDOCK
5     REM HTTPS://GITHUB.COM/JUSTINBALDOCK/X16-LABYRINTH
10    GOSUB 10000: REM INIT THE GAME AND SETUP VARIABLES AND CONSTANTS
20    GOSUB 11000: REM START THE GAME
127   REM ******************************
128   REM CREATE MAZE - SPAGETTI CODE
129   REM ******************************
130   A=H*V+C1
140   Q=C0:Z=C0:X=INT(H*RND(H))+C1
149   REM LINE 150-160 RECORD START POINT IN MAZE
150   AA=X
160   A(X,0)=C1:C=C2
170   R=X:S=C1:GOTO 240
180   IF R<>H GOTO 220
190   IF S<>V GOTO 210
200   R=C1:S=C1:GOTO 230
210   R=C1:S=S+C1:GOTO 230
220   R=R+C1
230   IF A(R,S-C1)=C0 GOTO 180
240   IF R-C1=C0 GOTO 560
250   IF A(R-C1,S-C1) GOTO 560
260   IF S-C1=C0 GOTO 400
270   IF A(R,S-C2)GOTO 400
280   IF R=H GOTO 320
290   IF A(R+C1,S-C1)GOTO 320
299   REM LEFT/DOWN/RIGHT
300   X=INT(C3*RND(C1))+C1
310   ON X GOTO 870,910,950
320   IF S<>V GOTO 350
330   IF Z=C1 GOTO 380
340   Q=C1:GOTO 360
350   IF A(R,S)GOTO 380
359   REM LEFT/DOWN/UP
360   X=INT(C3*RND(C1))+C1
370   ON X GOTO 870,910,1020
379   REM LEFT/DOWN
380   X=INT(C2*RND(C1))+C1
390   GOTO 370
400   IF R=H GOTO 500
410   IF A(R+C1,S-C1)GOTO 500
420   IF S<>V GOTO 450
430   IF Z=C1 GOTO 480
440   Q=C1:GOTO 460
450   IF A(R,S)GOTO 480
459   REM LEFT/RIGHT/UP
460   X=INT(C3*RND(C1))+C1
470   ON X GOTO 870,950,1020
479   REM LEFT/RIGHT
480   X=INT(C2*RND(C1))+C1
490   GOTO 470
500   IF S<>V GOTO 530
510   IF Z=C1 GOTO 870
520   Q=C1:GOTO 540
530   IF A(R,S)GOTO 870
539   REM LEFT/UP
540   X=INT(C2*RND(C1))+C1
550   ON X GOTO 870,1020
560   IF S-C1=C0 GOTO 740
570   IF A(R,S-C2)GOTO 740
580   IF R=H GOTO 680
590   IF A(R+C1,S-C1)GOTO 680
600   IF S<>V GOTO 630
610   IF Z=C1 GOTO 660
620   Q=C1:GOTO 640
630   IF A(R,S)GOTO 660
639   REM DOWN/RIGHT/UP
640   X=INT(C3*RND(C1))+C1
650   ON X GOTO 910,950,1020
659   REM DOWN/RIGHT
660   X=INT(C2*RND(C1))+C1
670   GOTO 650
680   IF S<>V GOTO 710
690   IF Z=C1 GOTO 910
700   Q=C1:GOTO 720
710   IF A(R,S)GOTO 910
719   REM DOWN/UP
720   X=INT(C2*RND(C1))+C1
730   ON X GOTO 910,1020
740   IF R=H GOTO 820
750   IF A(R+C1,S-C1)GOTO 820
760   IF S<>V GOTO 790
770   IF Z=C1 GOTO 950
780   Q=C1:GOTO 800
790   IF A(R,S)GOTO 950
799   REM RIGHT/UP
800   X=INT(C2*RND(C1))+C1
810   ON X GOTO 950,1020
820   IF S<>V GOTO 850
830   IF Z=C1 GOTO 180
840   Q=C1:GOTO860
850   IF A(R,S)GOTO 180
860   GOTO 1020
869   REM LEFT
870   A(R-C1,S-C1)=C
880   C=C+C1:B(R-C1,S-C1)=C2:R=R-C1
890   IF C=A GOTO 1120
900   Q=C0:GOTO 240
909   REM DOWN
910   A(R,S-C2)=C
920   C=C+C1
930   B(R,S-C2)=C1:S=S-C1:IF C=A GOTO 1120
940   Q=C0:GOTO 240
949   REM RIGHT
950   A(R+C1,S-C1)=C
960   C=C+C1:IF B(R,S-C1)=C0 GOTO 980
970   B(R,S-C1)=C3:GOTO 990
980   B(R,S-C1)=C2
990   R=R+C1
1000  IF C=A GOTO 1120
1010  GOTO560
1020  IF Q=C1 GOTO 1080
1029  REM UP
1030  A(R,S)=C:C=C+C1:IF B(R,S-C1)=C0 GOTO 1050
1040  B(R,S-C1)=C3:GOTO1060
1050  B(R,S-C1)=C1
1060  S=S+C1:IF C=A GOTO 1120
1070  GOTO 240
1079  REM EXIT AT TOP OF SCREEN
1080  Z=C1
1090  IFB(R,S-C1)=C0 GOTO 1110
1100  B(R,S-C1)=C3:Q=C0:GOTO 180
1110  B(R,S-C1)=C1:Q=C0:R=C1:S=C1:GOTO 230
1119  REM MAKE EXIT IF NOT THERE
1120  IF Z<>C1 THEN X=INT(H*RND(C1))+C1:B(X,V-C1)=B(X,V-C1)+C1
1121  REM END OF MAZE BUILD
1130  GOSUB 1140:
1132  REM POKE AN ARROW POINTING UP IN TO THE MAZE
1135  IF X6=1 THEN VPOKE 0,SC+(12*LL)+(36-(2*H))+(LL*V)+(2*2*AA),30:GOTO 1410
1136  IF X6=0 THEN POKE SC+12*LL+18-H+LL*V+2*AA,30:GOTO 1410
1139  REM ******************************
1140  REM DISPLAY THE ENTIRE MAZE
1141  REM ******************************
1142  REM THIS IS DRAWING THE WALLS OF THE MAZE NOT THE PATH
1150  M1=C1:PRINT CHR$($93);:IF V=11 THEN 1170
1160  FOR I=C1 TO 11-V:PRINT:NEXT I: REM PRINT BLANK LINES ABOVE MAZE
1170  FOR J=V TO C1 STEP -C1
1175  PRINT SPC(19-H): REM PRINT SPACES TO CENTER MAZE ON 40 COLUMN DISPLAY
1176  REM START OF HOZIZONTAL LINE - MOSTLY WALL
1180  FOR I=C1 TO H
1185  PRINT CHR$($12)" ";:REM REVERSE ON + SPACE, THE MAZE WALLS
1190  IF B(I,J-C1)=C0 GOTO 1230
1200  IF B(I,J-C1)=C2 GOTO 1230
1210  PRINT CHR$($90)" "CHR$($05);:REM BLACK + SPACE + WHITE, THE MAZE PATH
1220  GOTO 1240
1230  PRINT" ";
1240  NEXT I
1250  PRINT" ":REM LAST WALL CHARACTER ON LINE
1260  PRINT SPC(19-H) CHR$($12)" ";: REM CENTER MAZE ON 40 COL, LEFT SIDE WALL
1270  FOR I=C1 TO H
1275  PRINT CHR$($90)" "CHR$($05);
1280  IF B(I,J-C1)<C2 GOTO 1310
1290  PRINT CHR$($90)" "CHR$($05);
1300  GOTO 1320
1310  PRINT" ";
1320  NEXT I
1325  PRINT"": REM THIS FINISHS THE LINE
1340  NEXT J
1345  REM THIS IS BOTTOM ROW WITH ENTRANCE TO MAZE
1350  PRINT SPC(19-H)CHR$($12);: REM CENTER MAZE ON 40 COL, LEFT SIDE WALL
1355  FOR I=C1 TO H
1360  IF I=AA GOTO 1380
1370  PRINT"  ";:GOTO 1390:
1380  PRINT" "CHR$($90)" "CHR$($05);: REM THIS IS ENTRANCE TO MAZE
1390  NEXT I
1400  PRINT" "
1405  RETURN: REM END DISPLAY THE ENTIRE MAZE
1406  REM ******************************
1410  W=AA
1420  FOR J=C0 TO V-C1
1430  FOR I=C1 TO H
1440  IF J GOTO 1470
1450  IF I=W THEN A(I,J)=(C3-B(I,J))*C2:GOTO 1490
1460  M=C1:GOTO 1480
1470  M=(A(I,J-C1)AND2)/C2
1480  A(I,J)=(C3-B(I,J))*C2+M*C8
1490  IF I=C1 THEN M=C1:GOTO 1510
1500  M=(A(I-C1,J)AND4)/C4
1510  A(I,J)=A(I,J)+M
1520  NEXT I: REM LOOP-1430
1530  NEXT J: REM LOOP-1420
1540  PRINT "": REM CHR$($93): REM THIS CLEARS THE SCREEN
1550  X=W:Y=C0:Z=C1:EL=C1:ER=C1
1560  GOTO 2260
1570  PRINT CHR$($11)CHR$($11)"YOU CAN GIVE THE FOLLOWING INSTRUCTIONS:";
